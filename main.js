!function(){"use strict";const e={formSelector:".modal__form",inputSelector:".modal__input-name",submitButtonSelector:".modal__save-button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},t=(e,t,r)=>{const o=e.querySelector(`.${t.id}-error`);t.classList.remove(r.inputErrorClass),o.classList.remove(r.errorClass),o.textContent=""},r=e=>{e.disabled=!0},o=e=>e.some(e=>!e.validity.valid),n=(e,t,n)=>{console.log(o(e)),o(e)?(t.classList.add(n.inactiveButtonClass),r(t)):(t.classList.remove(n.inactiveButtonClass),t.disabled=!1)},a=new class{constructor({baseUrl:e,headers:t}){this._baseUrl=e,this._headers=t}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}editUserInfo({name:e,about:t}){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}editavatarInfo({avatar:e}){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}addCard({name:e,link:t}){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}likeCard({isLiked:e,id:t}){return fetch(`${this._baseUrl}/cards/${t}/likes`,{method:"PUT",headers:this._headers,body:JSON.stringify({isLiked:e})}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}unlikeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"52c275a0-bc3b-40b6-9de1-91f319344d34","Content-Type":"application/json"}});a.getAppInfo().then(([e,t])=>{b.textContent=t.name,q.textContent=t.about,k.src=t.avatar,e.forEach(function(e){const t=m(e);l.prepend(t)})}).catch(e=>{console.error(e)});const s=document.querySelector("#card-template"),l=document.querySelector(".cards__list"),c=document.querySelector("#image-modal"),i=c.querySelector(".modal__image"),d=c.querySelector(".modal__caption"),u=c.querySelector(".modal__x-btn"),m=e=>{const t=s.content.querySelector(".card").cloneNode(!0);t.querySelector(".card__description").textContent=e.name;const r=t.querySelector(".card__image");r.setAttribute("src",e.link),r.setAttribute("alt",e.name),r.addEventListener("click",()=>{Y(c),i.setAttribute("src",e.link),i.setAttribute("alt",e.name),d.textContent=e.name});const o=t.querySelector(".card__like-logo");return e.isLiked?o.classList.add("card__like-logo_color_red"):o.classList.remove("card__like-logo_color_red"),o.addEventListener("click",()=>{o.classList.contains("card__like-logo_color_red")?function(e,t){a.unlikeCard(e).then(()=>{t.classList.toggle("card__like-logo_color_red")})}(e._id,o):function(e,t){a.likeCard({isLiked:!0,id:e}).then(()=>{t.classList.toggle("card__like-logo_color_red")})}(e._id,o)}),t.querySelector(".card__delete-btn").addEventListener("click",()=>{!function(e,t){z=e,M=t,Y(N)}(t,e._id)}),t};u.addEventListener("click",()=>{Z(c)});const _=document.querySelector("#edit-profile-modal"),h=_.querySelector(".modal__save-button"),v=document.querySelector("#new-post-modal"),f=document.querySelector(".profile__edit"),y=_.querySelector(".modal__close-button"),S=document.querySelector(".profile__button"),p=v.querySelector(".modal__close-button"),b=document.querySelector(".profile__name"),q=document.querySelector(".profile__description"),k=document.querySelector(".profile__image"),E=_.querySelector("#input-name"),L=_.querySelector("#input-description"),C=_.querySelector(".modal__form"),g=v.querySelector(".modal__form"),$=g.querySelector("#card-image-name"),x=g.querySelector("#card-caption-name"),j=g.querySelector(".modal__save-button"),A=document.querySelector(".profile__avatar-btn"),U=document.querySelector("#avatar-modal"),P=U.querySelector(".modal__form"),I=U.querySelector(".modal__save-button"),T=U.querySelector(".modal__close-button"),D=U.querySelector("#profile-avatar-input"),B=document.querySelector(".profile__pencil-icon"),N=document.querySelector("#delete-modal"),O=N.querySelector(".modal__close-button"),w=N.querySelector(".modal__save-button_type_cancel"),J=N.querySelector(".modal__save-button_type_delete"),H=N.querySelector(".modal__form");let z,M;const F=Array.from(_.querySelectorAll(".modal__input-name")),G=_.querySelector(".modal__save-button");function K(e){const t=document.querySelector(".modal_is-opened");e.target===e.currentTarget&&Z(t)}const Q=()=>{document.querySelectorAll(".modal").forEach(e=>{e.addEventListener("click",K)})},R=()=>{document.querySelectorAll(".modal").forEach(e=>{e.removeEventListener("click",K)})},V=e=>{document.querySelectorAll(".modal").forEach(t=>{t.classList.contains("modal_is-opened")&&"Escape"===e.key&&Z(t)})},W=()=>{document.addEventListener("keydown",V)},X=()=>{document.removeEventListener("keydown",V)};function Y(e){e.classList.add("modal_is-opened"),Q(),W()}function Z(e){e.classList.remove("modal_is-opened"),X(),R()}f.addEventListener("click",function(){((e,r,o)=>{r.forEach(r=>{t(e,r,o)})})(C,[E,L],e),n(F,G,e),Y(_),E.value=b.textContent,L.value=q.textContent}),y.addEventListener("click",function(){Z(_)}),S.addEventListener("click",function(){Y(v)}),p.addEventListener("click",function(){Z(v)}),A.addEventListener("click",function(){Y(U)}),T.addEventListener("click",function(){Z(U)}),O.addEventListener("click",function(){Z(N)}),w.addEventListener("click",()=>{Z(N)}),C.addEventListener("submit",function(e){e.preventDefault(),h.textContent="saving...",a.editUserInfo({name:E.value,about:L.value}).then(e=>{b.textContent=e.name,q.textContent=e.about,Z(_)}).catch(e=>{console.error(e)}).finally(()=>{h.textContent="save"})}),g.addEventListener("submit",function(t){t.preventDefault(),j.textContent="saving...",a.addCard({name:x.value,link:$.value}).then(t=>{Z(v);const o=m({name:t.name,link:t.link});l.prepend(o),g.reset(),j.classList.add(e.inactiveButtonClass),r(j)}).catch(console.error).finally(()=>{j.textContent="save"})}),H.addEventListener("submit",e=>{var t;t=J,e.preventDefault(),t.textContent="deleting...",a.deleteCard(M).then(()=>{Z(N),z.remove()}).catch(console.error).finally(()=>{t.textContent="delete"})}),P.addEventListener("submit",function(e){e.preventDefault(),I.textContent="saving...",a.editavatarInfo({avatar:D.value}).then(e=>{B.src=`<%=require('${e.avatar}')%>`,Z(U),P.reset()}).catch(e=>{console.error(e)}).finally(()=>{I.textContent="save"})}),(e=>{const r=document.querySelectorAll(e.formSelector);console.log(r),r.forEach(r=>{r.addEventListener("submit",e=>{e.preventDefault()}),((e,r)=>{const o=Array.from(e.querySelectorAll(r.inputSelector)),a=e.querySelector(r.submitButtonSelector);n(o,a,r),o.forEach(s=>{s.addEventListener("input",function(){((e,r,o)=>{r.validity.valid?t(e,r,o):((e,t,r,o)=>{const n=e.querySelector(`.${t.id}-error`);t.classList.add(o.inputErrorClass),n.classList.add(o.errorClass),n.textContent=r})(e,r,r.validationMessage,o)})(e,s,r),n(o,a,r)})})})(r,e)})})(e)}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SUFBSW5CLEVBQU9KLFlBQ2hDSyxFQUFXSyxZQUFjaUosR0FrQnZCRCxDQUFleEosRUFBV0MsRUFBWUEsRUFBV3lKLGtCQUFtQnhKLElBbUNsRXFKLENBQW1CdkosRUFBV0MsRUFBWUMsR0FDMUNlLEVBQWtCSixFQUFXSyxFQUFlaEIsRUFDOUMsTUFVQW9KLENBQWtCUixFQUFhNUksTUM2T25DeUosQ0FBaUJuSyxFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9zY3JpcHRzL3ZhbGlkYXRlLmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy91dGlscy9BcGkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IHNldHRpbmdzID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXQtbmFtZVwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc2F2ZS1idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXHJcbn07XHJcblxyXG5jb25zdCBzaG93SW5wdXRFcnJvciA9IChtb2RhbEZvcm0sIG1vZGFsSW5wdXQsIGVycm9yTWVzc2FnZSwgY29uZmlnKSA9PiB7XHJcbiAgY29uc3QgaW5wdXRFcnJvciA9IG1vZGFsRm9ybS5xdWVyeVNlbGVjdG9yKGAuJHttb2RhbElucHV0LmlkfS1lcnJvcmApO1xyXG4gIG1vZGFsSW5wdXQuY2xhc3NMaXN0LmFkZChjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcclxuICBpbnB1dEVycm9yLmNsYXNzTGlzdC5hZGQoY29uZmlnLmVycm9yQ2xhc3MpO1xyXG4gIGlucHV0RXJyb3IudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XHJcbn07XHJcblxyXG5jb25zdCBoaWRlSW5wdXRFcnJvciA9IChtb2RhbEZvcm0sIG1vZGFsSW5wdXQsIGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGlucHV0RXJyb3IgPSBtb2RhbEZvcm0ucXVlcnlTZWxlY3RvcihgLiR7bW9kYWxJbnB1dC5pZH0tZXJyb3JgKTtcclxuICBtb2RhbElucHV0LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgaW5wdXRFcnJvci5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5lcnJvckNsYXNzKTtcclxuICBpbnB1dEVycm9yLnRleHRDb250ZW50ID0gXCJcIjtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCByZXNldFZhbGlkYXRpb24gPSAoZm9ybUVsZW1lbnQsIGlucHV0TGlzdCwgY29uZmlnKSA9PiB7XHJcbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXQsIGNvbmZpZyk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG5jb25zdCBjaGVja0lucHV0VmFsaWRpdHkgPSAobW9kYWxGb3JtLCBtb2RhbElucHV0LCBjb25maWcpID0+IHtcclxuICBpZiAoIW1vZGFsSW5wdXQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgIHNob3dJbnB1dEVycm9yKG1vZGFsRm9ybSwgbW9kYWxJbnB1dCwgbW9kYWxJbnB1dC52YWxpZGF0aW9uTWVzc2FnZSwgY29uZmlnKTtcclxuICB9IGVsc2Uge1xyXG4gICAgaGlkZUlucHV0RXJyb3IobW9kYWxGb3JtLCBtb2RhbElucHV0LCBjb25maWcpO1xyXG4gIH1cclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBkaXNhYmxlZFN1Ym1pdEJ1dHRvbiA9IChidXR0b25FbCkgPT4ge1xyXG4gIGJ1dHRvbkVsLmRpc2FibGVkID0gdHJ1ZTtcclxufTtcclxuXHJcbmNvbnN0IGhhc0ludmFsaWRJbnB1dCA9IChpbnB1dExpc3QpID0+IHtcclxuICByZXR1cm4gaW5wdXRMaXN0LnNvbWUoKG1vZGFsSW5wdXQpID0+IHtcclxuICAgIHJldHVybiAhbW9kYWxJbnB1dC52YWxpZGl0eS52YWxpZDtcclxuICB9KTtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCB0b2dnbGVCdXR0b25TdGF0ZSA9IChpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZykgPT4ge1xyXG4gIGNvbnNvbGUubG9nKGhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKTtcclxuICBpZiAoaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkpIHtcclxuICAgIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZChjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICBkaXNhYmxlZFN1Ym1pdEJ1dHRvbihidXR0b25FbGVtZW50KTtcclxuICB9IGVsc2Uge1xyXG4gICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIGJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcclxuICB9XHJcbn07XHJcblxyXG5jb25zdCBzZXRFdmVudExpc3RlbmVycyA9IChtb2RhbEZvcm0sIGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICBtb2RhbEZvcm0ucXVlcnlTZWxlY3RvckFsbChjb25maWcuaW5wdXRTZWxlY3RvcilcclxuICApO1xyXG4gIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBtb2RhbEZvcm0ucXVlcnlTZWxlY3Rvcihjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcclxuICBpbnB1dExpc3QuZm9yRWFjaCgobW9kYWxJbnB1dCkgPT4ge1xyXG4gICAgbW9kYWxJbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICBjaGVja0lucHV0VmFsaWRpdHkobW9kYWxGb3JtLCBtb2RhbElucHV0LCBjb25maWcpO1xyXG4gICAgICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XHJcbiAgICB9KTtcclxuICB9KTtcclxufTtcclxuZXhwb3J0IGNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoY29uZmlnKSA9PiB7XHJcbiAgY29uc3QgZm9ybUxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpO1xyXG4gIGNvbnNvbGUubG9nKGZvcm1MaXN0KTtcclxuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xyXG4gICAgZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSk7XHJcbiAgICBzZXRFdmVudExpc3RlbmVycyhmb3JtRWxlbWVudCwgY29uZmlnKTtcclxuICB9KTtcclxufTtcclxuIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuaW1wb3J0IHtcclxuICBkaXNhYmxlZFN1Ym1pdEJ1dHRvbixcclxuICBlbmFibGVWYWxpZGF0aW9uLFxyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlLFxyXG4gIHJlc2V0VmFsaWRhdGlvbixcclxuICBzZXR0aW5ncyxcclxufSBmcm9tIFwiLi4vc2NyaXB0cy92YWxpZGF0ZS5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi91dGlscy9BcGkuanNcIjtcclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcIjUyYzI3NWEwLWJjM2ItNDBiNi05ZGUxLTkxZjMxOTM0NGQzNFwiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfSxcclxufSk7XHJcblxyXG5hcGlcclxuICAuZ2V0QXBwSW5mbygpXHJcbiAgLnRoZW4oKFtjYXJkcywgdXNlckluZm9dKSA9PiB7XHJcbiAgICBwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IHVzZXJJbmZvLm5hbWU7XHJcbiAgICBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSB1c2VySW5mby5hYm91dDtcclxuICAgIHByb2ZpbGVJbWFnZS5zcmMgPSB1c2VySW5mby5hdmF0YXI7XHJcbiAgICBjYXJkcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgIGNvbnN0IGNhcmQgPSBnZXRDYXJkRWxlbWVudChpdGVtKTtcclxuICAgICAgY2FyZENvbnRhaW5lci5wcmVwZW5kKGNhcmQpO1xyXG4gICAgfSk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gIH0pO1xyXG5cclxuY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpO1xyXG5jb25zdCBjYXJkQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcclxuY29uc3QgaW1hZ2VNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjaW1hZ2UtbW9kYWxcIik7XHJcbmNvbnN0IG1vZGFsUGljdHVyZSA9IGltYWdlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XHJcbmNvbnN0IG1vZGFsQ2FwdGlvbiA9IGltYWdlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FwdGlvblwiKTtcclxuY29uc3QgbW9kYWxJbWFnZUNsb3NlQnRuID0gaW1hZ2VNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX194LWJ0blwiKTtcclxuY29uc3QgZ2V0Q2FyZEVsZW1lbnQgPSAoZGF0YSkgPT4ge1xyXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZFRlbXBsYXRlLmNvbnRlbnRcclxuICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcclxuICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgY29uc3QgY2FyZFRpdGxlID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZXNjcmlwdGlvblwiKTtcclxuICBjYXJkVGl0bGUudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgY29uc3QgY2FyZEltYWdlID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICBjYXJkSW1hZ2Uuc2V0QXR0cmlidXRlKFwic3JjXCIsIGRhdGEubGluayk7XHJcbiAgY2FyZEltYWdlLnNldEF0dHJpYnV0ZShcImFsdFwiLCBkYXRhLm5hbWUpO1xyXG4gIGNhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgb3Blbk1vZGFsKGltYWdlTW9kYWwpO1xyXG4gICAgbW9kYWxQaWN0dXJlLnNldEF0dHJpYnV0ZShcInNyY1wiLCBkYXRhLmxpbmspO1xyXG4gICAgbW9kYWxQaWN0dXJlLnNldEF0dHJpYnV0ZShcImFsdFwiLCBkYXRhLm5hbWUpO1xyXG4gICAgbW9kYWxDYXB0aW9uLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gIH0pO1xyXG4gIGNvbnN0IGxpa2VCdG4gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtbG9nb1wiKTtcclxuICBpZiAoZGF0YS5pc0xpa2VkKSB7XHJcbiAgICBsaWtlQnRuLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWxvZ29fY29sb3JfcmVkXCIpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBsaWtlQnRuLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWxvZ29fY29sb3JfcmVkXCIpO1xyXG4gIH1cclxuICBsaWtlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBpZiAobGlrZUJ0bi5jbGFzc0xpc3QuY29udGFpbnMoXCJjYXJkX19saWtlLWxvZ29fY29sb3JfcmVkXCIpKSB7XHJcbiAgICAgIGhhbmRsZVVubGlrZUNhcmQoZGF0YS5faWQsIGxpa2VCdG4pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaGFuZGxlTGlrZUNhcmQoZGF0YS5faWQsIGxpa2VCdG4pO1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICBjb25zdCBkZWxldGVDYXJkQnRuID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnRuXCIpO1xyXG4gIGRlbGV0ZUNhcmRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIGhhbmRsZURlbGV0ZUNhcmQoY2FyZEVsZW1lbnQsIGRhdGEuX2lkKTtcclxuICB9KTtcclxuICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbn07XHJcblxyXG5tb2RhbEltYWdlQ2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjbG9zZU1vZGFsKGltYWdlTW9kYWwpO1xyXG59KTtcclxuXHJcbmNvbnN0IHByb2ZpbGVFZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtcHJvZmlsZS1tb2RhbFwiKTtcclxuY29uc3QgcHJvZmlsZVN1Ym1pdEJ0biA9IHByb2ZpbGVFZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc2F2ZS1idXR0b25cIik7XHJcbmNvbnN0IG5ld1Bvc3RNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbmV3LXBvc3QtbW9kYWxcIik7XHJcbmNvbnN0IGVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXRcIik7XHJcbmNvbnN0IHByb2ZpbGVDbG9zZUJ0biA9IHByb2ZpbGVFZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnV0dG9uXCIpO1xyXG5jb25zdCBwb3N0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19idXR0b25cIik7XHJcbmNvbnN0IHBvc3RDbG9zZUJ0biA9IG5ld1Bvc3RNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idXR0b25cIik7XHJcbmNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lXCIpO1xyXG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpO1xyXG5jb25zdCBwcm9maWxlSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2ltYWdlXCIpO1xyXG5jb25zdCBpbnB1dE5hbWUgPSBwcm9maWxlRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjaW5wdXQtbmFtZVwiKTtcclxuY29uc3QgaW5wdXREZXNjcmlwdGlvbiA9IHByb2ZpbGVFZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIiNpbnB1dC1kZXNjcmlwdGlvblwiKTtcclxuY29uc3QgZm9ybVN1Ym1pdCA9IHByb2ZpbGVFZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuY29uc3QgYWRkQ2FyZEZvcm1FbGVtZW50ID0gbmV3UG9zdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbmNvbnN0IGxpbmtJbnB1dCA9IGFkZENhcmRGb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtaW1hZ2UtbmFtZVwiKTtcclxuY29uc3QgY2FwdGlvbklucHV0ID0gYWRkQ2FyZEZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC1jYXB0aW9uLW5hbWVcIik7XHJcbmNvbnN0IGNhcmRNb2RhbFNhdmVCdG4gPSBhZGRDYXJkRm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIi5tb2RhbF9fc2F2ZS1idXR0b25cIlxyXG4pO1xyXG5jb25zdCBwcm9maWxlQWF2YXRhckJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyLWJ0blwiKTtcclxuXHJcbi8vYXZhdGFyIGZvcm0gZWxlbWVudHNcclxuY29uc3QgYXZhdGFyTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2F2YXRhci1tb2RhbFwiKTtcclxuY29uc3QgYXZhdGFyRm9ybSA9IGF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbmNvbnN0IGF2YXRhclN1Ym1pdEJ0biA9IGF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3NhdmUtYnV0dG9uXCIpO1xyXG5jb25zdCBhdmF0YXJDbG9zZUJ0biA9IGF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiKTtcclxuY29uc3QgYXZhdGFySW5wdXQgPSBhdmF0YXJNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtYXZhdGFyLWlucHV0XCIpO1xyXG5jb25zdCBwcm9maWxlUGVuY2lsSWNvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fcGVuY2lsLWljb25cIik7XHJcblxyXG4vL2RlbGV0ZSBtb2RhbCBlbGVtZW50c1xyXG5jb25zdCBkZWxldGVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZGVsZXRlLW1vZGFsXCIpO1xyXG5jb25zdCBkZWxldGVNb2RhbENsb3NlQnRuID0gZGVsZXRlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnV0dG9uXCIpO1xyXG5jb25zdCBjYW5jZWxNb2RhbEJ0biA9IGRlbGV0ZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIubW9kYWxfX3NhdmUtYnV0dG9uX3R5cGVfY2FuY2VsXCJcclxuKTtcclxuY29uc3QgZGVsZWxlTW9kYWxCdG4gPSBkZWxldGVNb2RhbC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLm1vZGFsX19zYXZlLWJ1dHRvbl90eXBlX2RlbGV0ZVwiXHJcbik7XHJcbmNvbnN0IGRlbGV0ZUZvcm0gPSBkZWxldGVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG5cclxuLy8gZGVsZXRlIGNhcmQgZnJvbSB0aGUgc2VydmVyXHJcblxyXG5sZXQgc2VsZWN0ZWRDYXJkO1xyXG5sZXQgc2VsZWN0ZWRDYXJkSWQ7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDYXJkKGNhcmRFbGVtZW50LCBjYXJkSWQpIHtcclxuICBzZWxlY3RlZENhcmQgPSBjYXJkRWxlbWVudDtcclxuICBzZWxlY3RlZENhcmRJZCA9IGNhcmRJZDtcclxuICBvcGVuTW9kYWwoZGVsZXRlTW9kYWwpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVNb2RhbFN1Ym1pdChlLCBlbGVtZW50KSB7XHJcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGVsZW1lbnQudGV4dENvbnRlbnQgPSBcImRlbGV0aW5nLi4uXCI7XHJcbiAgYXBpXHJcbiAgICAuZGVsZXRlQ2FyZChzZWxlY3RlZENhcmRJZClcclxuICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgY2xvc2VNb2RhbChkZWxldGVNb2RhbCk7XHJcbiAgICAgIHNlbGVjdGVkQ2FyZC5yZW1vdmUoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgZWxlbWVudC50ZXh0Q29udGVudCA9IFwiZGVsZXRlXCI7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlTGlrZUNhcmQoZGF0YSwgZWxlbWVudCkge1xyXG4gIGFwaS5saWtlQ2FyZCh7IGlzTGlrZWQ6IHRydWUsIGlkOiBkYXRhIH0pLnRoZW4oKCkgPT4ge1xyXG4gICAgZWxlbWVudC5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1sb2dvX2NvbG9yX3JlZFwiKTtcclxuICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlVW5saWtlQ2FyZChkYXRhLCBlbGVtZW50KSB7XHJcbiAgYXBpLnVubGlrZUNhcmQoZGF0YSkudGhlbigoKSA9PiB7XHJcbiAgICBlbGVtZW50LmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWxvZ29fY29sb3JfcmVkXCIpO1xyXG4gIH0pO1xyXG59XHJcblxyXG5jb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKFxyXG4gIHByb2ZpbGVFZGl0TW9kYWwucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXQtbmFtZVwiKVxyXG4pO1xyXG5jb25zdCBidXR0b25FbGVtZW50ID0gcHJvZmlsZUVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zYXZlLWJ1dHRvblwiKTtcclxuXHJcbmZ1bmN0aW9uIGNsb3NlTW9kYWxPdmVybGF5KGV2dCkge1xyXG4gIGNvbnN0IGN1cnJlbnRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfaXMtb3BlbmVkXCIpO1xyXG4gIGlmIChldnQudGFyZ2V0ID09PSBldnQuY3VycmVudFRhcmdldCkge1xyXG4gICAgY2xvc2VNb2RhbChjdXJyZW50TW9kYWwpO1xyXG4gIH1cclxufVxyXG5jb25zdCBhZGRMaXN0ZW5lck1vZGFsT3ZlcmxheSA9ICgpID0+IHtcclxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsXCIpLmZvckVhY2goKG1vZGFsRWxlbWVudCkgPT4ge1xyXG4gICAgbW9kYWxFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBjbG9zZU1vZGFsT3ZlcmxheSk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG5jb25zdCByZW1vdmVMaXN0ZW5lck1vZGFsT3ZlcmxheSA9ICgpID0+IHtcclxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsXCIpLmZvckVhY2goKG1vZGFsRWxlbWVudCkgPT4ge1xyXG4gICAgbW9kYWxFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBjbG9zZU1vZGFsT3ZlcmxheSk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG5jb25zdCBldmVudExpc3RlbmVyRXNjYXBlS2V5ID0gKGV2dCkgPT4ge1xyXG4gIGNvbnN0IG1vZGFscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxcIik7XHJcbiAgbW9kYWxzLmZvckVhY2goKG1vZGFsKSA9PiB7XHJcbiAgICBpZiAobW9kYWwuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfaXMtb3BlbmVkXCIpICYmIGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgY2xvc2VNb2RhbChtb2RhbCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcbn07XHJcblxyXG5jb25zdCBhZGRFdmVudExpc3RlbmVyRXNjYXBlS2V5ID0gKCkgPT4ge1xyXG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGV2ZW50TGlzdGVuZXJFc2NhcGVLZXkpO1xyXG59O1xyXG5cclxuY29uc3QgcmVtb3ZlRXZlbnRMaXN0ZW5lckVzY2FwZUtleSA9ICgpID0+IHtcclxuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBldmVudExpc3RlbmVyRXNjYXBlS2V5KTtcclxufTtcclxuXHJcbmZ1bmN0aW9uIG9wZW5Nb2RhbChtb2RhbCkge1xyXG4gIG1vZGFsLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9pcy1vcGVuZWRcIik7XHJcbiAgYWRkTGlzdGVuZXJNb2RhbE92ZXJsYXkoKTtcclxuICBhZGRFdmVudExpc3RlbmVyRXNjYXBlS2V5KCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNsb3NlTW9kYWwobW9kYWwpIHtcclxuICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfaXMtb3BlbmVkXCIpO1xyXG4gIHJlbW92ZUV2ZW50TGlzdGVuZXJFc2NhcGVLZXkoKTtcclxuICByZW1vdmVMaXN0ZW5lck1vZGFsT3ZlcmxheSgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBvcGVuRWRpdENvbnRlbnQoKSB7XHJcbiAgcmVzZXRWYWxpZGF0aW9uKGZvcm1TdWJtaXQsIFtpbnB1dE5hbWUsIGlucHV0RGVzY3JpcHRpb25dLCBzZXR0aW5ncyk7XHJcbiAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBzZXR0aW5ncyk7XHJcbiAgb3Blbk1vZGFsKHByb2ZpbGVFZGl0TW9kYWwpO1xyXG4gIGlucHV0TmFtZS52YWx1ZSA9IHByb2ZpbGVOYW1lLnRleHRDb250ZW50O1xyXG4gIGlucHV0RGVzY3JpcHRpb24udmFsdWUgPSBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQ7XHJcbn1cclxuXHJcbmVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9wZW5FZGl0Q29udGVudCk7XHJcblxyXG5wcm9maWxlQ2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICBjbG9zZU1vZGFsKHByb2ZpbGVFZGl0TW9kYWwpO1xyXG59KTtcclxuXHJcbnBvc3RCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICBvcGVuTW9kYWwobmV3UG9zdE1vZGFsKTtcclxufSk7XHJcblxyXG5wb3N0Q2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICBjbG9zZU1vZGFsKG5ld1Bvc3RNb2RhbCk7XHJcbn0pO1xyXG5cclxucHJvZmlsZUFhdmF0YXJCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICBvcGVuTW9kYWwoYXZhdGFyTW9kYWwpO1xyXG59KTtcclxuXHJcbmF2YXRhckNsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgY2xvc2VNb2RhbChhdmF0YXJNb2RhbCk7XHJcbn0pO1xyXG5cclxuZGVsZXRlTW9kYWxDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gIGNsb3NlTW9kYWwoZGVsZXRlTW9kYWwpO1xyXG59KTtcclxuXHJcbmNhbmNlbE1vZGFsQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgY2xvc2VNb2RhbChkZWxldGVNb2RhbCk7XHJcbn0pO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQoZSkge1xyXG4gIGUucHJldmVudERlZmF1bHQoKTtcclxuICBwcm9maWxlU3VibWl0QnRuLnRleHRDb250ZW50ID0gXCJzYXZpbmcuLi5cIjtcclxuICBhcGlcclxuICAgIC5lZGl0VXNlckluZm8oeyBuYW1lOiBpbnB1dE5hbWUudmFsdWUsIGFib3V0OiBpbnB1dERlc2NyaXB0aW9uLnZhbHVlIH0pXHJcbiAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICBwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuICAgICAgcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gZGF0YS5hYm91dDtcclxuICAgICAgY2xvc2VNb2RhbChwcm9maWxlRWRpdE1vZGFsKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgICB9KVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBwcm9maWxlU3VibWl0QnRuLnRleHRDb250ZW50ID0gXCJzYXZlXCI7XHJcbiAgICB9KTtcclxufVxyXG5mb3JtU3VibWl0LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQpO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlQ2FyZEZvcm1TdWJtaXQoZSkge1xyXG4gIGUucHJldmVudERlZmF1bHQoKTtcclxuICBjYXJkTW9kYWxTYXZlQnRuLnRleHRDb250ZW50ID0gXCJzYXZpbmcuLi5cIjtcclxuICBhcGlcclxuICAgIC5hZGRDYXJkKHsgbmFtZTogY2FwdGlvbklucHV0LnZhbHVlLCBsaW5rOiBsaW5rSW5wdXQudmFsdWUgfSlcclxuICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgIGNsb3NlTW9kYWwobmV3UG9zdE1vZGFsKTtcclxuICAgICAgY29uc3QgY2FyZCA9IGdldENhcmRFbGVtZW50KHtcclxuICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXHJcbiAgICAgICAgbGluazogZGF0YS5saW5rLFxyXG4gICAgICB9KTtcclxuICAgICAgY2FyZENvbnRhaW5lci5wcmVwZW5kKGNhcmQpO1xyXG5cclxuICAgICAgYWRkQ2FyZEZvcm1FbGVtZW50LnJlc2V0KCk7XHJcbiAgICAgIGNhcmRNb2RhbFNhdmVCdG4uY2xhc3NMaXN0LmFkZChzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgZGlzYWJsZWRTdWJtaXRCdXR0b24oY2FyZE1vZGFsU2F2ZUJ0bik7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIGNhcmRNb2RhbFNhdmVCdG4udGV4dENvbnRlbnQgPSBcInNhdmVcIjtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVBdmF0YXJTdWJtaXQoZSkge1xyXG4gIGUucHJldmVudERlZmF1bHQoKTtcclxuICBhdmF0YXJTdWJtaXRCdG4udGV4dENvbnRlbnQgPSBcInNhdmluZy4uLlwiO1xyXG4gIGFwaVxyXG4gICAgLmVkaXRhdmF0YXJJbmZvKHsgYXZhdGFyOiBhdmF0YXJJbnB1dC52YWx1ZSB9KVxyXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgcHJvZmlsZVBlbmNpbEljb24uc3JjID0gYDwlPXJlcXVpcmUoJyR7ZGF0YS5hdmF0YXJ9JyklPmA7XHJcbiAgICAgIGNsb3NlTW9kYWwoYXZhdGFyTW9kYWwpO1xyXG4gICAgICBhdmF0YXJGb3JtLnJlc2V0KCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gICAgfSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgYXZhdGFyU3VibWl0QnRuLnRleHRDb250ZW50ID0gXCJzYXZlXCI7XHJcbiAgICB9KTtcclxufVxyXG5cclxuYWRkQ2FyZEZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlQ2FyZEZvcm1TdWJtaXQpO1xyXG5cclxuZGVsZXRlRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICBoYW5kbGVEZWxldGVNb2RhbFN1Ym1pdChldnQsIGRlbGVsZU1vZGFsQnRuKTtcclxufSk7XHJcblxyXG5hdmF0YXJGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlQXZhdGFyU3VibWl0KTtcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcclxuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgZ2V0QXBwSW5mbygpIHtcclxuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRJbml0aWFsQ2FyZHMoKSwgdGhpcy5nZXRVc2VySW5mbygpXSk7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlZGl0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAvLyBTZW5kIHRoZSBkYXRhIGluIHRoZSBib2R5IGFzIGEgSlNPTiBzdHJpbmcuXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lLFxyXG4gICAgICAgIGFib3V0LFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlZGl0YXZhdGFySW5mbyh7IGF2YXRhciB9KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgLy8gU2VuZCB0aGUgZGF0YSBpbiB0aGUgYm9keSBhcyBhIEpTT04gc3RyaW5nLlxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGF2YXRhciB9KSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGRDYXJkKHsgbmFtZSwgbGluayB9KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIC8vIFNlbmQgdGhlIGRhdGEgaW4gdGhlIGJvZHkgYXMgYSBKU09OIHN0cmluZy5cclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgbGluayxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChpZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgbGlrZUNhcmQoeyBpc0xpa2VkLCBpZCB9KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgLy8gU2VuZCB0aGUgZGF0YSBpbiB0aGUgYm9keSBhcyBhIEpTT04gc3RyaW5nLlxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGlzTGlrZWQgfSksXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgdW5saWtlQ2FyZChpZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIG90aGVyIG1ldGhvZHMgZm9yIHdvcmtpbmcgd2l0aCB0aGUgQVBJXHJcbn1cclxuIl0sIm5hbWVzIjpbInNldHRpbmdzIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJoaWRlSW5wdXRFcnJvciIsIm1vZGFsRm9ybSIsIm1vZGFsSW5wdXQiLCJjb25maWciLCJpbnB1dEVycm9yIiwicXVlcnlTZWxlY3RvciIsImlkIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwidGV4dENvbnRlbnQiLCJkaXNhYmxlZFN1Ym1pdEJ1dHRvbiIsImJ1dHRvbkVsIiwiZGlzYWJsZWQiLCJoYXNJbnZhbGlkSW5wdXQiLCJpbnB1dExpc3QiLCJzb21lIiwidmFsaWRpdHkiLCJ2YWxpZCIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiYnV0dG9uRWxlbWVudCIsImNvbnNvbGUiLCJsb2ciLCJhZGQiLCJhcGkiLCJjb25zdHJ1Y3RvciIsImJhc2VVcmwiLCJoZWFkZXJzIiwidGhpcyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJnZXRBcHBJbmZvIiwiUHJvbWlzZSIsImFsbCIsImdldEluaXRpYWxDYXJkcyIsImdldFVzZXJJbmZvIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwicmVqZWN0Iiwic3RhdHVzIiwiZWRpdFVzZXJJbmZvIiwibmFtZSIsImFib3V0IiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJlZGl0YXZhdGFySW5mbyIsImF2YXRhciIsImFkZENhcmQiLCJsaW5rIiwiZGVsZXRlQ2FyZCIsImxpa2VDYXJkIiwiaXNMaWtlZCIsInVubGlrZUNhcmQiLCJhdXRob3JpemF0aW9uIiwiY2FyZHMiLCJ1c2VySW5mbyIsInByb2ZpbGVOYW1lIiwicHJvZmlsZURlc2NyaXB0aW9uIiwicHJvZmlsZUltYWdlIiwic3JjIiwiZm9yRWFjaCIsIml0ZW0iLCJjYXJkIiwiZ2V0Q2FyZEVsZW1lbnQiLCJjYXJkQ29udGFpbmVyIiwicHJlcGVuZCIsImNhdGNoIiwiZXJyIiwiZXJyb3IiLCJjYXJkVGVtcGxhdGUiLCJkb2N1bWVudCIsImltYWdlTW9kYWwiLCJtb2RhbFBpY3R1cmUiLCJtb2RhbENhcHRpb24iLCJtb2RhbEltYWdlQ2xvc2VCdG4iLCJkYXRhIiwiY2FyZEVsZW1lbnQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiY2FyZEltYWdlIiwic2V0QXR0cmlidXRlIiwiYWRkRXZlbnRMaXN0ZW5lciIsIm9wZW5Nb2RhbCIsImxpa2VCdG4iLCJjb250YWlucyIsImVsZW1lbnQiLCJ0b2dnbGUiLCJoYW5kbGVVbmxpa2VDYXJkIiwiX2lkIiwiaGFuZGxlTGlrZUNhcmQiLCJjYXJkSWQiLCJzZWxlY3RlZENhcmQiLCJzZWxlY3RlZENhcmRJZCIsImRlbGV0ZU1vZGFsIiwiaGFuZGxlRGVsZXRlQ2FyZCIsImNsb3NlTW9kYWwiLCJwcm9maWxlRWRpdE1vZGFsIiwicHJvZmlsZVN1Ym1pdEJ0biIsIm5ld1Bvc3RNb2RhbCIsImVkaXRCdXR0b24iLCJwcm9maWxlQ2xvc2VCdG4iLCJwb3N0QnRuIiwicG9zdENsb3NlQnRuIiwiaW5wdXROYW1lIiwiaW5wdXREZXNjcmlwdGlvbiIsImZvcm1TdWJtaXQiLCJhZGRDYXJkRm9ybUVsZW1lbnQiLCJsaW5rSW5wdXQiLCJjYXB0aW9uSW5wdXQiLCJjYXJkTW9kYWxTYXZlQnRuIiwicHJvZmlsZUFhdmF0YXJCdG4iLCJhdmF0YXJNb2RhbCIsImF2YXRhckZvcm0iLCJhdmF0YXJTdWJtaXRCdG4iLCJhdmF0YXJDbG9zZUJ0biIsImF2YXRhcklucHV0IiwicHJvZmlsZVBlbmNpbEljb24iLCJkZWxldGVNb2RhbENsb3NlQnRuIiwiY2FuY2VsTW9kYWxCdG4iLCJkZWxlbGVNb2RhbEJ0biIsImRlbGV0ZUZvcm0iLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiY2xvc2VNb2RhbE92ZXJsYXkiLCJldnQiLCJjdXJyZW50TW9kYWwiLCJ0YXJnZXQiLCJjdXJyZW50VGFyZ2V0IiwiYWRkTGlzdGVuZXJNb2RhbE92ZXJsYXkiLCJtb2RhbEVsZW1lbnQiLCJyZW1vdmVMaXN0ZW5lck1vZGFsT3ZlcmxheSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldmVudExpc3RlbmVyRXNjYXBlS2V5IiwibW9kYWwiLCJrZXkiLCJhZGRFdmVudExpc3RlbmVyRXNjYXBlS2V5IiwicmVtb3ZlRXZlbnRMaXN0ZW5lckVzY2FwZUtleSIsInJlc2V0VmFsaWRhdGlvbiIsImZvcm1FbGVtZW50IiwiaW5wdXQiLCJ2YWx1ZSIsImUiLCJwcmV2ZW50RGVmYXVsdCIsImZpbmFsbHkiLCJyZXNldCIsImZvcm1MaXN0Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJjaGVja0lucHV0VmFsaWRpdHkiLCJzaG93SW5wdXRFcnJvciIsImVycm9yTWVzc2FnZSIsInZhbGlkYXRpb25NZXNzYWdlIiwiZW5hYmxlVmFsaWRhdGlvbiJdLCJzb3VyY2VSb290IjoiIn0=